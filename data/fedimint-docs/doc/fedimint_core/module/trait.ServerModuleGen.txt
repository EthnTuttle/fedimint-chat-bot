☰
logo [../../static.files/rust-logo-151179464ae7ed46.svg]
../../fedimint_core/index.html




logo [../../static.files/rust-logo-151179464ae7ed46.svg]
../../fedimint_core/index.html


SERVERMODULEGEN


REQUIRED ASSOCIATED TYPES

 * Params


REQUIRED ASSOCIATED CONSTANTS

 * DATABASE_VERSION


REQUIRED METHODS

 * distributed_gen
 * dump_database
 * get_client_config
 * init
 * supported_api_versions
 * trusted_dealer_gen
 * validate_config
 * versions


PROVIDED METHODS

 * get_database_migrations
 * kind
 * parse_params


IMPLEMENTORS


IN FEDIMINT_CORE::MODULE [index.html]

? [../../help.html]
Change settings [../../static.files/wheel-5ec35bf9ca753509.svg]../../settings.html


TRAIT FEDIMINT_CORE [../index.html]::MODULE [index.html]::SERVERMODULEGENCopy item path
[../../static.files/clipboard-7571035ce49a181d.svg]

source [../../src/fedimint_core/module/mod.rs.html#538-613] · [−]

pub trait ServerModuleGen: ExtendsCommonModuleGentrait.ExtendsCommonModuleGen.html + Sizedhttps://doc.rust-lang.org/1.67.0/core/marker/trait.Sized.html {
    type Params: ModuleGenParams../config/trait.ModuleGenParams.html;

    const DATABASE_VERSION: DatabaseVersion../db/struct.DatabaseVersion.html;

    fn versions(&self, core: CoreConsensusVersionversion/struct.CoreConsensusVersion.html) -> &[ModuleConsensusVersionversion/struct.ModuleConsensusVersion.html];
    fn supported_api_versions(&self) -> SupportedModuleApiVersionsversion/struct.SupportedModuleApiVersions.html;
    fn init<'life0, 'life1, 'async_trait>(
        &'life0 self,
        cfg: ServerModuleConfig../config/struct.ServerModuleConfig.html,
        db: Database../db/struct.Database.html,
        task_group: &'life1 mut TaskGroup../task/struct.TaskGroup.html
    ) -> Pinhttps://doc.rust-lang.org/1.67.0/core/pin/struct.Pin.html<Boxhttps://doc.rust-lang.org/1.67.0/alloc/boxed/struct.Box.html<dyn Futurehttps://doc.rust-lang.org/1.67.0/core/future/future/trait.Future.html<Output = Resulthttps://docs.rs/anyhow/1.0.71/anyhow/type.Result.html<DynServerModule../core/server/struct.DynServerModule.html>> + Sendhttps://doc.rust-lang.org/1.67.0/core/marker/trait.Send.html + 'async_trait>>
    where
        Self: 'async_trait,
        'life0: 'async_trait,
        'life1: 'async_trait;
    fn trusted_dealer_gen(
        &self,
        peers: &[PeerId../struct.PeerId.html],
        params: &ConfigGenModuleParams../config/struct.ConfigGenModuleParams.html
    ) -> BTreeMaphttps://doc.rust-lang.org/1.67.0/alloc/collections/btree/map/struct.BTreeMap.html<PeerId../struct.PeerId.html, ServerModuleConfig../config/struct.ServerModuleConfig.html>;
    fn distributed_gen<'life0, 'life1, 'life2, 'async_trait>(
        &'life0 self,
        peer: &'life1 PeerHandlestruct.PeerHandle.html<'_>,
        params: &'life2 ConfigGenModuleParams../config/struct.ConfigGenModuleParams.html
    ) -> Pinhttps://doc.rust-lang.org/1.67.0/core/pin/struct.Pin.html<Boxhttps://doc.rust-lang.org/1.67.0/alloc/boxed/struct.Box.html<dyn Futurehttps://doc.rust-lang.org/1.67.0/core/future/future/trait.Future.html<Output = DkgResult../config/type.DkgResult.html<ServerModuleConfig../config/struct.ServerModuleConfig.html>> + Sendhttps://doc.rust-lang.org/1.67.0/core/marker/trait.Send.html + 'async_trait>>
    where
        Self: 'async_trait,
        'life0: 'async_trait,
        'life1: 'async_trait,
        'life2: 'async_trait;
    fn validate_config(
        &self,
        identity: &PeerId../struct.PeerId.html,
        config: ServerModuleConfig../config/struct.ServerModuleConfig.html
    ) -> Resulthttps://docs.rs/anyhow/1.0.71/anyhow/type.Result.html<()https://doc.rust-lang.org/1.67.0/std/primitive.unit.html>;
    fn get_client_config(
        &self,
        config: &ServerModuleConsensusConfig../config/struct.ServerModuleConsensusConfig.html
    ) -> Resulthttps://docs.rs/anyhow/1.0.71/anyhow/type.Result.html<<<Self as ExtendsCommonModuleGentrait.ExtendsCommonModuleGen.html>::Commontrait.ExtendsCommonModuleGen.html#associatedtype.Common as CommonModuleGentrait.CommonModuleGen.html>::ClientConfigtrait.CommonModuleGen.html#associatedtype.ClientConfig>;
    fn dump_database<'life0, 'life1, 'life2, 'async_trait>(
        &'life0 self,
        dbtx: &'life1 mut ModuleDatabaseTransaction../db/struct.ModuleDatabaseTransaction.html<'life2>,
        prefix_names: Vechttps://doc.rust-lang.org/1.67.0/alloc/vec/struct.Vec.html<Stringhttps://doc.rust-lang.org/1.67.0/alloc/string/struct.String.html>
    ) -> Pinhttps://doc.rust-lang.org/1.67.0/core/pin/struct.Pin.html<Boxhttps://doc.rust-lang.org/1.67.0/alloc/boxed/struct.Box.html<dyn Futurehttps://doc.rust-lang.org/1.67.0/core/future/future/trait.Future.html<Output = Boxhttps://doc.rust-lang.org/1.67.0/alloc/boxed/struct.Box.html<dyn Iteratorhttps://doc.rust-lang.org/1.67.0/core/iter/traits/iterator/trait.Iterator.html<Item = (Stringhttps://doc.rust-lang.org/1.67.0/alloc/string/struct.String.html, Boxhttps://doc.rust-lang.org/1.67.0/alloc/boxed/struct.Box.html<dyn Serializehttps://docs.rs/erased-serde/0.3.25/erased_serde/ser/trait.Serialize.html + Sendhttps://doc.rust-lang.org/1.67.0/core/marker/trait.Send.html>)> + '_>> + Sendhttps://doc.rust-lang.org/1.67.0/core/marker/trait.Send.html + 'async_trait>>
    where
        Self: 'async_trait,
        'life0: 'async_trait,
        'life1: 'async_trait,
        'life2: 'async_trait;

    fn kind() -> ModuleKind../core/struct.ModuleKind.html { ... }
    fn get_database_migrations(&self) -> MigrationMap../db/type.MigrationMap.html<'_> { ... }
    fn parse_params(
        &self,
        params: &ConfigGenModuleParams../config/struct.ConfigGenModuleParams.html
    ) -> Resulthttps://docs.rs/anyhow/1.0.71/anyhow/type.Result.html<Self::Paramstrait.ServerModuleGen.html#associatedtype.Params> { ... }
}

Expand description

Module Generation trait with associated types

Needs to be implemented by module generation type

For examples, take a look at one of the MintConfigGenerator, WalletConfigGenerator, or LightningConfigGenerator structs.


REQUIRED ASSOCIATED TYPES§

source [../../src/fedimint_core/module/mod.rs.html#539]

TYPE PARAMS: MODULEGENPARAMS [../config/trait.ModuleGenParams.html]


REQUIRED ASSOCIATED CONSTANTS§

source [../../src/fedimint_core/module/mod.rs.html#547]

CONST DATABASE_VERSION: DATABASEVERSION [../db/struct.DatabaseVersion.html]

This represents the module’s database version that the current code is compatible with. It is important to increment this value
whenever a key or a value that is persisted to the database within the module changes. It is also important to add the
corresponding migration function in get_database_migrations which should define how to move from the previous database version to
the current version.


REQUIRED METHODS§

source [../../src/fedimint_core/module/mod.rs.html#561]

FN VERSIONS(&SELF, CORE: CORECONSENSUSVERSION [version/struct.CoreConsensusVersion.html]) -> &[MODULECONSENSUSVERSION
[version/struct.ModuleConsensusVersion.html]]

Version of the module consensus supported by this implementation given a certain CoreConsensusVersion
[version/struct.CoreConsensusVersion.html].

Refer to ModuleConsensusVersion [version/struct.ModuleConsensusVersion.html] for more information about versioning.

One module implementation (ServerModuleGen [trait.ServerModuleGen.html] of a given ModuleKind [../core/struct.ModuleKind.html])
can potentially implement multiple versions of the consensus, and depending on the config module instance config, instantiate the
desired one. This method should expose all the available versions, purely for information, setup UI and sanity checking purposes.

source [../../src/fedimint_core/module/mod.rs.html#563]

FN SUPPORTED_API_VERSIONS(&SELF) -> SUPPORTEDMODULEAPIVERSIONS [version/struct.SupportedModuleApiVersions.html]

source [../../src/fedimint_core/module/mod.rs.html#570-575]

FN INIT<'LIFE0, 'LIFE1, 'ASYNC_TRAIT>(
    &'LIFE0 SELF,
    CFG: SERVERMODULECONFIG [../config/struct.ServerModuleConfig.html],
    DB: DATABASE [../db/struct.Database.html],
    TASK_GROUP: &'LIFE1 MUT TASKGROUP [../task/struct.TaskGroup.html]
) -> PIN [https://doc.rust-lang.org/1.67.0/core/pin/struct.Pin.html]<BOX
[https://doc.rust-lang.org/1.67.0/alloc/boxed/struct.Box.html]<DYN FUTURE
[https://doc.rust-lang.org/1.67.0/core/future/future/trait.Future.html]<OUTPUT = RESULT
[https://docs.rs/anyhow/1.0.71/anyhow/type.Result.html]<DYNSERVERMODULE [../core/server/struct.DynServerModule.html]>> + SEND
[https://doc.rust-lang.org/1.67.0/core/marker/trait.Send.html] + 'ASYNC_TRAIT>>WHERE
    SELF: 'ASYNC_TRAIT,
    'LIFE0: 'ASYNC_TRAIT,
    'LIFE1: 'ASYNC_TRAIT,

Initialize the DynServerModule [../core/server/struct.DynServerModule.html] instance from its config

source [../../src/fedimint_core/module/mod.rs.html#588-592]

FN TRUSTED_DEALER_GEN(
    &SELF,
    PEERS: &[PEERID [../struct.PeerId.html]],
    PARAMS: &CONFIGGENMODULEPARAMS [../config/struct.ConfigGenModuleParams.html]
) -> BTREEMAP [https://doc.rust-lang.org/1.67.0/alloc/collections/btree/map/struct.BTreeMap.html]<PEERID [../struct.PeerId.html],
SERVERMODULECONFIG [../config/struct.ServerModuleConfig.html]>

source [../../src/fedimint_core/module/mod.rs.html#594-598]

FN DISTRIBUTED_GEN<'LIFE0, 'LIFE1, 'LIFE2, 'ASYNC_TRAIT>(
    &'LIFE0 SELF,
    PEER: &'LIFE1 PEERHANDLE [struct.PeerHandle.html]<'_>,
    PARAMS: &'LIFE2 CONFIGGENMODULEPARAMS [../config/struct.ConfigGenModuleParams.html]
) -> PIN [https://doc.rust-lang.org/1.67.0/core/pin/struct.Pin.html]<BOX
[https://doc.rust-lang.org/1.67.0/alloc/boxed/struct.Box.html]<DYN FUTURE
[https://doc.rust-lang.org/1.67.0/core/future/future/trait.Future.html]<OUTPUT = DKGRESULT
[../config/type.DkgResult.html]<SERVERMODULECONFIG [../config/struct.ServerModuleConfig.html]>> + SEND
[https://doc.rust-lang.org/1.67.0/core/marker/trait.Send.html] + 'ASYNC_TRAIT>>WHERE
    SELF: 'ASYNC_TRAIT,
    'LIFE0: 'ASYNC_TRAIT,
    'LIFE1: 'ASYNC_TRAIT,
    'LIFE2: 'ASYNC_TRAIT,

source [../../src/fedimint_core/module/mod.rs.html#600]

FN VALIDATE_CONFIG(
    &SELF,
    IDENTITY: &PEERID [../struct.PeerId.html],
    CONFIG: SERVERMODULECONFIG [../config/struct.ServerModuleConfig.html]
) -> RESULT [https://docs.rs/anyhow/1.0.71/anyhow/type.Result.html]<() [https://doc.rust-lang.org/1.67.0/std/primitive.unit.html]>

source [../../src/fedimint_core/module/mod.rs.html#603-606]

FN GET_CLIENT_CONFIG(
    &SELF,
    CONFIG: &SERVERMODULECONSENSUSCONFIG [../config/struct.ServerModuleConsensusConfig.html]
) -> RESULT [https://docs.rs/anyhow/1.0.71/anyhow/type.Result.html]<<<SELF AS EXTENDSCOMMONMODULEGEN
[trait.ExtendsCommonModuleGen.html]>::COMMON [trait.ExtendsCommonModuleGen.html#associatedtype.Common] AS COMMONMODULEGEN
[trait.CommonModuleGen.html]>::CLIENTCONFIG [trait.CommonModuleGen.html#associatedtype.ClientConfig]>

Converts the consensus config into the client config

source [../../src/fedimint_core/module/mod.rs.html#608-612]

FN DUMP_DATABASE<'LIFE0, 'LIFE1, 'LIFE2, 'ASYNC_TRAIT>(
    &'LIFE0 SELF,
    DBTX: &'LIFE1 MUT MODULEDATABASETRANSACTION [../db/struct.ModuleDatabaseTransaction.html]<'LIFE2>,
    PREFIX_NAMES: VEC [https://doc.rust-lang.org/1.67.0/alloc/vec/struct.Vec.html]<STRING
[https://doc.rust-lang.org/1.67.0/alloc/string/struct.String.html]>
) -> PIN [https://doc.rust-lang.org/1.67.0/core/pin/struct.Pin.html]<BOX
[https://doc.rust-lang.org/1.67.0/alloc/boxed/struct.Box.html]<DYN FUTURE
[https://doc.rust-lang.org/1.67.0/core/future/future/trait.Future.html]<OUTPUT = BOX
[https://doc.rust-lang.org/1.67.0/alloc/boxed/struct.Box.html]<DYN ITERATOR
[https://doc.rust-lang.org/1.67.0/core/iter/traits/iterator/trait.Iterator.html]<ITEM = (STRING
[https://doc.rust-lang.org/1.67.0/alloc/string/struct.String.html], BOX
[https://doc.rust-lang.org/1.67.0/alloc/boxed/struct.Box.html]<DYN SERIALIZE
[https://docs.rs/erased-serde/0.3.25/erased_serde/ser/trait.Serialize.html] + SEND
[https://doc.rust-lang.org/1.67.0/core/marker/trait.Send.html]>)> + '_>> + SEND
[https://doc.rust-lang.org/1.67.0/core/marker/trait.Send.html] + 'ASYNC_TRAIT>>WHERE
    SELF: 'ASYNC_TRAIT,
    'LIFE0: 'ASYNC_TRAIT,
    'LIFE1: 'ASYNC_TRAIT,
    'LIFE2: 'ASYNC_TRAIT,


PROVIDED METHODS§

source [../../src/fedimint_core/module/mod.rs.html#565-567]

FN KIND() -> MODULEKIND [../core/struct.ModuleKind.html]

source [../../src/fedimint_core/module/mod.rs.html#580-582]

FN GET_DATABASE_MIGRATIONS(&SELF) -> MIGRATIONMAP [../db/type.MigrationMap.html]<'_>

Retrieves the MigrationMap from the module to be applied to the database before the module is initialized. The MigrationMap is
indexed on the from version.

source [../../src/fedimint_core/module/mod.rs.html#584-586]

FN PARSE_PARAMS(&SELF, PARAMS: &CONFIGGENMODULEPARAMS [../config/struct.ConfigGenModuleParams.html]) -> RESULT
[https://docs.rs/anyhow/1.0.71/anyhow/type.Result.html]<SELF::PARAMS [trait.ServerModuleGen.html#associatedtype.Params]>


IMPLEMENTORS§


